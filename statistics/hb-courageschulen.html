<!DOCTYPE html>
<html>
    <head>
        <style>
            @font-face {
                font-family: 'Apfel Grotezk';
                src: url('/resources/fonts/apfel-grotezk-latin-400-normal.woff2') format('woff2');
            }
            @font-face {
                font-family: 'Apfel Grotezk';
                src: url('/resources/fonts/apfel-grotezk-latin-700-normal.woff2') format('woff2');
            }

            body {
                max-width: 30cm;
                margin: auto;
                background-color: #212121;
                color: #F3F6F6;
            }
            h1, h2, h3, h4, h5, h6 {
                font-family: 'Apfel Grotezk', sans-serif;
                font-weight: 700;
            }
            p {
                padding-top: 640px;
                font-family: 'Apfel Grotezk', sans-serif;
            }
            .horizontal-display {
                width: 100%;
            }
            @media screen and (min-width: 20cm) {
                .horizontal-display-child {
                    width: 50%;
                    float: left;
                }
            }
            .vertical-display {
                width: 100%;
            }
            a:link {
                color: #c2e8ff;
            }

            /* visited link */
            a:visited {
                color: #ffd7f0;
            }

            /* mouse over link */
            a:hover {
                color: #ffdad5;
            }
        </style>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
        <script>
            var colorLight = '#F3F6F6'
            var colorDark = '#161C1D'

            document.addEventListener('DOMContentLoaded', function() {
                createCharts();
            }, false);

            function pickTextColorBasedOnBgColorSimple(bgColor) {
                var color = (bgColor.charAt(0) === '#') ? bgColor.substring(1, 7) : bgColor;
                var r = parseInt(color.substring(0, 2), 16); // hexToR
                var g = parseInt(color.substring(2, 4), 16); // hexToG
                var b = parseInt(color.substring(4, 6), 16); // hexToB
                return (((r * 0.299) + (g * 0.587) + (b * 0.114)) > 128) ? colorDark : colorLight;
            }

            function createCharts() {
                var pieBackgroundColorsRegion = [
                    '#ED254E', '#F9DC5C', '#00E0B7', '#011936', '#6930BA'
                ];
                var pieBackgroundColorsRegionAlt = [
                    '#BFD7EA', '#508CA4', '#102B3F', '#0A8754', '#004F2D'
                ];
                var pieBackgroundColorsSchulart = [
                    '#F53232', '#E39632', '#61B9E5', '#7DE174', '#B07EE8'
                ];
                var labelsRegionen = ['Nord', 'Ost', 'Süd', 'West', 'Mitte & Östliche Vorstadt'];
                labelsSchulart = ['Grundschulen', 'Oberschulen', 'Gymnasien', 'Berufsbildende Schulen', 'Sonstige'];
                var datasetRegionGesamt = [34, 51, 38, 33, 39];
                var datasetRegionPlakette = [6, 8, 4, 8, 11];
                var datasetSchulartGesamt = [87, 41, 10, 26, 31];
                var datasetSchulartPlakette = [1, 21, 7, 7, 1];

                var barChartOptions = {
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: '#3D5252'
                            },
                            ticks: {
                                font: {
                                    size: 14,
                                    family: 'Apfel Grotezk',
                                    weight: 400,
                                },
                                color: colorLight
                            }
                        },
                        x: {
                            grid: {
                                color: '#232F2F'
                            },
                            ticks: {
                                font: {
                                    size: 14,
                                    family: 'Apfel Grotezk',
                                    weight: 400,
                                },
                                color: colorLight
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                font: {
                                    size: 16,
                                    family: 'Apfel Grotezk',
                                    weight: 400,
                                },
                                color: colorLight
                            }
                        }
                    }
                };
                var pieChartOptionsRegion = {
                    tooltips: {
                        enabled: false,
                    },
                    plugins: {
                        datalabels: {
                            formatter: (value, ctx) => {
                                const datapoints = ctx.chart.data.datasets[0].data;
                                const total = datapoints.reduce((total, datapoint) => total + datapoint, 0);
                                const percentage = value / total * 100;
                                return percentage.toFixed(1) + "%\n(" + value + ")";
                            },
                            color: [
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsRegionAlt[0]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsRegionAlt[1]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsRegionAlt[2]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsRegionAlt[3]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsRegionAlt[4])
                            ],
                            font: {
                                size: 16,
                                family: 'Apfel Grotezk',
                                weight: 400,
                                titleAlign: 'center',
                            },
                        },
                        legend: {
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Apfel Grotezk',
                                    weight: 400,
                                },
                                color: colorLight
                            }
                        }
                    }
                };
                var pieChartOptionsSchulart = {
                    tooltips: {
                        enabled: false,
                    },
                    plugins: {
                        datalabels: {
                            formatter: (value, ctx) => {
                                const datapoints = ctx.chart.data.datasets[0].data;
                                const total = datapoints.reduce((total, datapoint) => total + datapoint, 0);
                                const percentage = value / total * 100;
                                return percentage.toFixed(1) + "%\n(" + value + ")";
                            },
                            color: [
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsSchulart[0]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsSchulart[1]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsSchulart[2]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsSchulart[3]),
                                pickTextColorBasedOnBgColorSimple(pieBackgroundColorsSchulart[4])
                            ],
                            font: {
                                size: 16,
                                family: 'Apfel Grotezk',
                                weight: 400,
                                titleAlign: 'center',
                            },
                        },
                        legend: {
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Apfel Grotezk',
                                    weight: 400,
                                },
                                color: colorLight
                            }
                        }
                    }
                };
                
                new Chart(document.getElementById("regionChart"), {
                    type: 'bar',
                    data: {
                        labels: labelsRegionen,
                        datasets: [{
                            label: 'Gesamtzahl',
                            data: datasetRegionGesamt,
                            borderRadius: 10,
                            borderWidth: 1,
                            backgroundColor: '#4A99E8',
                        }, {
                            label: 'Mit Plakette',
                            data: datasetRegionPlakette,
                            borderRadius: 10,
                            borderWidth: 1,
                            backgroundColor: '#CB48B7',
                        }],
                    },
                    options: barChartOptions
                });
                
                new Chart(document.getElementById("regionChartPieGesamt"), {
                    type: 'pie',
                    data: {
                        labels: labelsRegionen,
                        datasets: [{
                            label: 'Gesamt',
                            data: datasetRegionGesamt,
                            backgroundColor: pieBackgroundColorsRegionAlt,
                            borderWidth: 0.6,
                            hoverOffset: 4
                        }]
                    },
                    plugins: [ChartDataLabels],
                    options: pieChartOptionsRegion
                });
                
                new Chart(document.getElementById("regionChartPiePlakette"), {
                    type: 'pie',
                    data: {
                        labels: labelsRegionen,
                        datasets: [{
                            label: 'Gesamt',
                            data: datasetRegionPlakette,
                            backgroundColor: pieBackgroundColorsRegionAlt,
                            borderWidth: 0.6,
                            hoverOffset: 4
                        }]
                    },
                    plugins: [ChartDataLabels],
                    options: pieChartOptionsRegion
                });

                new Chart(document.getElementById("detailedChart"), {
                    type: 'bar',
                    data: {
                        labels: labelsSchulart,
                        datasets: [{
                            label: 'Gesamt',
                            data: datasetSchulartGesamt,
                            borderRadius: 10,
                            borderWidth: 1,
                            backgroundColor: '#F15025',
                        }, {
                            label: 'Mit Plakette',
                            data: datasetSchulartPlakette,
                            borderRadius: 10,
                            borderWidth: 1,
                            backgroundColor: '#3EB690',
                        }]
                    },
                    options: barChartOptions
                });
                
                new Chart(document.getElementById("detailedChartPieGesamt"), {
                    type: 'pie',
                    data: {
                        labels: labelsSchulart,
                        datasets: [{
                            label: 'Gesamt',
                            data: datasetSchulartGesamt,
                            backgroundColor: pieBackgroundColorsSchulart,
                            borderWidth: 0.6,
                            hoverOffset: 4
                        }]
                    },
                    plugins: [ChartDataLabels],
                    options: pieChartOptionsSchulart
                });
                
                new Chart(document.getElementById("detailedChartPiePlakette"), {
                    type: 'pie',
                    data: {
                        labels: labelsSchulart,
                        datasets: [{
                            label: 'Gesamt',
                            data: datasetSchulartPlakette,
                            backgroundColor: pieBackgroundColorsSchulart,
                            borderWidth: 0.6,
                            hoverOffset: 4
                        }]
                    },
                    plugins: [ChartDataLabels],
                    options: pieChartOptionsSchulart
                });
            }
        </script>
    </head>
    <body>
        <h1>Courageschulen in der Stadt Bremen</h1>
        <div class="vertical-display">
            <h2>Schulen nach Region</h2>
            <canvas id="regionChart"></canvas>
            <div class="horizontal-display">
                <div class="horizontal-display-child">
                    <h3>Aufteilung aller Schulen</h3>
                    <canvas id="regionChartPieGesamt"></canvas>
                </div>
                <div class="horizontal-display-child">
                    <h3>Schulen mit Plakette</h3>
                    <canvas id="regionChartPiePlakette"></canvas>
                </div>
            </div>
        </div>
        <div class="vertical-display">
            <h2 style="display: block;">Schulen nach Schulart</h2>
            <canvas id="detailedChart"></canvas>
            <div class="horizontal-display">
                <div class="horizontal-display-child">
                    <h3>Gesamte Schulzahl</h3>
                    <canvas id="detailedChartPieGesamt"></canvas>
                </div>
                <div class="horizontal-display-child">
                    <h3>Schulen mit Plakette</h3>
                    <canvas id="detailedChartPiePlakette"></canvas>
                </div>
            </div>
        </div>
        <p>
            Statistiken erstellt auf Basis von Daten des <a href="https://www.bildung.bremen.de/schulwegweiser-3714">Schulwegweisers der Senatorin für Kinder und Bildung Bremen</a> sowie der <a href="https://www.courageschulen-bremen.de/in-aktion/schulen/">Auflistung von Courage-Schulen in Bremen</a> der Landeszentrale für politische Bildung Bremen.<br>Darstellungen erstellt mit <a href="https://www.chartjs.org/">Chart.js</a>.<br><br>Statistik erstellt 2023-12-03.
        </p>
    </body>
</html>