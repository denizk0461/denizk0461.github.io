<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width'>
        <title>Project N5; Development Log – denizk0461</title>
        <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="/stylesheets/pagestyle2.css">
        <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
        <script type="text/javascript" src="/common/GradientHeaders.js"></script>
        <script>
            $(function(){
                $("#banner").load("/common/banner.html");
                $("#rat-footer").load("/common/rat-footer.html");

                // randomise page title gradient colours
                applyGradientHeaders(document);
            });
        </script>
        <style>
            code {
                background-color: #D4AB4966;
                border-radius: 8px;
                padding-left: 6px;
                padding-right: 6px;
            }
        </style>
    </head>
    <body>
        <div id="banner"></div>
        <div class="body-container">
            <div class="width-conforming">
                <h1 id="title" class="gradient-title page-title">Project N5; Development Log</h1>
                <p>This is the development log for my game <b>Project N5</b>. Updates are shown in reverse chronological order.</p>

                <h2 class="gradient-title">December 2023</h2>

                <h2 class="gradient-title">November 2023</h2>

                <h2 class="gradient-title">October 2023</h2>
                <h3 class="gradient-title">Quick Select, Part II – Design</h3>
                <p></p>
                <h3 class="gradient-title">Quick Select, Part I – Functionality</h3>
                <p>I've done some work on the quick select menu to get it functional. The goal is to emulate its behaviour in the Ratchet & Clank games (duh). Current functionality is as follows:</p>
                <p>The Quick Select menu opens when the E key (keyboard) or the northern face button (controller) is pressed, and closes once the button is released. Using the Keyboard/Mouse control layout, the player is able to pick a weapon by hovering over it. The focussed weapon is equipped once the Quick Select menu is closed. Controller users point the left stick in the desired direction to focus on an item.</p>
                <h3 class="gradient-title">What Are the Controls??</h3>
                <p>We have a controls screen! This task would have been easier if the game was specific to a console, thus necessitating only one controller layout. Instead, I used Godot's <code>Input.get_joy_name()</code> function to retrieve the first connected controller's name, and use that to display an appropriate screen. Current options are PlayStation (DualSense), Xbox (Series X/S), and Nintendo (Switch Pro Con). Keyboard/Mouse layout will follow soon(ish).</p>
                <p>Specifying controller layouts for different controllers is difficult though, since I don't know the controller's names (I currently only have the following strings: “PS5 Controller”, “XInput Gamepad” (through emulation using DS4Windows), and “Nintendo Switch Pro Controller”).</p>
                <p>Another difficulty is figuring out which controller layout to show if multiple controllers are connected, or when KBM is used even though a controller is connected. I currently check for the first connected controller, which means that, if multiple controllers are connected, the layout shown may be wrong. Furthermore, connecting a controller always overrides the KBM layout, since KBM is currently the default. A solution to this may be to check which controller last sent an input, and retrieving that controller's name.</p>
                <h3 class="gradient-title">Healthy</h3>
                <p>We now have health points! As it is currently set up, the health bar supports up to 8 health points. For testing purposes, I set up the melee attack to drain health, and the gunshot to heal the player.</p>
                <p>The health bar even aligns properly for 5 and 6 max health points, reducing the max points displayed per line from 4 to 3!</p>
                <h3 class="gradient-title">Implementing RigidBody3D Character Movement</h3>
                <p>Today's task: reimplementing my player character as a <code>RigidBody3D</code>. In the example below, it is using <code>CharacterController3D</code>. I wanted to make this change to get more natural feeling movement and physics, particularly in carrying momentum.</p>
                <p>oops i've had a bit of a tumble</p>
                <p>This is the result of the <code>RigidBody3D</code> implementation in my character. I used a script from the following video, which served as a great base – the only good one I could find, in fact. Most people on the internet seem to want others to use <code>CharacterController3D</code>, and for good reasons; it's simple, it works, and it's easy to adjust and tweak, unlike a <code>RigidBody3D</code>. And so I had to admit: I wasn't happy with my implementation. I changed the script in large parts, only keeping a few segments, but it never felt quite like I wanted to. It felt too loose.</p>
                <p><a href="https://www.youtube.com/watch?v=ZLTYlZgZc-0&t=986s">Godot 4.0: I solved my CharacterBody3d issues by using RigidBody3d for character movement!</a></p>
                <p><code>RigidBody3D</code> also greeted me with some bugs I had encountered in Unity but was spared from when I switched to Godot. A significant issue was the double jump; the character would often not be able to recognise that it had been grounded, and thus it would not allow the player to jump again. Another issue was glitching; the video shows how the character sinks into the ground briefly before jumping up. I have no idea why this happened.</p>
                <p>Using a momentum-based character also introduces the issue of sliding up slopes and ramps with the carried momentum a little more than I would like.</p>
                <p>And so, after 10 hours of implementing RigidBody3D, I decided to go back to CharacterController3D. I played a bit of Ratchet & Clank for reference, and decided that they might be using a <code>RigidBody</code> implementation (did a <code>CharacterController</code> even exist back then? Did their engine support that even?), but I could get closer to their movement more easily using a <code>CharacterController</code> and emulating a few momentum-based movements using lerp</code>s.</p>
                <p>The effort was not in vain, however! I implemented the ground <code>RayCast</code> that was necessary for my <code>RigidBody3D</code> implementation in my <code>CharacterController</code>, which, together with a plane calculation, allows for adjusting the character movement velocity when moving on slopes! This corrects the player's uphill speed, and it also prevents jumpy movement when running down a slope! It's currently a little glitch-prone though, crashing the game when standing on Sans, for example, but I'll fix that soon.</p>

                <h2 class="gradient-title">September 2023</h2>
                <h3 class="gradient-title">Learning to Model and Rig a Character</h3>
                <p>today's task: modelling and rigging a character from scratch</p>
                <p>(Ratchet for scale)</p>
                <p>whaddya lookin at pinhead</p>
                <p>is it a bird? is it a plane? no, it's arms</p>
                <p>*Mii Maker theme intensifies*</p>
                <p>feet are difficult</p>
                <p>yoooo actually, not half bad</p>
                <p>that one might hurt</p>
                <p>we have a character!!</p>
                <p><i>we've been rigged!</i></p>
                <p><code>we come in peace</code></p>
                <p>brief texture troubles</p>
                <p>my character is now a playable character</p>
                <h3 class="gradient-title">Language Options</h3>
                <p>The game now supports English and German as language options! Godot makes this very easy. All that's needed is to create a table with keys and the corresponding translations, export it as CSV, add them to the game (and don't forget to add the generated translation files in the project settings as well!), and then use <code>TranslationServer.setLocale(locale)</code> to set the language whenever needed – game defaults to English <code>en</code>. For UI elements, supplying the key in the text field suffices, and for strings in script, use <code>tr(key)</code>. Easy as that!</p>
                <h3 class="gradient-title">Smooth Player Movement</h3>
                <p>Using <code>lerp()</code> as well as <code>lerp_rotation()</code>, the player's movements are now smoother than before! The character rotates smoothly whenever pointing in a given direction and when strafing. Furthermore, the character now has a slight acceleration and deceleration in their movement.</p>
                <h3 class="gradient-title">Don't Waste Your Ammo!</h3>
                <p>Guns now have ammo counters! They can only fire for as long as they have ammunition left – as it should be. Unfortunately, unloading bullets unto Sans does nothing.</p>
                <h3 class="gradient-title">Conversation Camera</h3>
                <p>There's now a special camera angle for conversations with NPCs! Unfortunately, as the camera is bound to the player, and the player's position is unmodified when entering a conversation, this can result in blocking the NPC, or even facing a different direction entirely – how rude!</p>
                <h3 class="gradient-title">Dialogue</h3>
                <p>The game now supports talking with NPCs. I only implemented this because I thought of something funny and I wanted to put it in the game.</p>
                <h3 class="gradient-title">A Gun</h3>
                <p>The gun can shoot! Or can it? Well, the bullet doesn't exactly move…</p>
                <p>Bullets have been converted into <code>RigidBody3D</code> which is great for collision but unfortunately initialises the bullets to be affected by gravity. Since the bullets are also parented to the player, it means that the fallen bullets move with the player. I don't think that's how guns are supposed to work.</p>
                <p>The gun now shoots properly! Not only do the bullets fly, but they fly in the correct direction as well! This is possible thanks to simple vector math, as the only thing needed to calculate a velocity vector for the bullet is to put two nodes on the gun, one at the front (where the bullet will fly from) and one further back, and calculate a vector between the two nodes!</p>
                <h3 class="gradient-title">Helicopter Ratchet</h3>
                <p>character go spinny</p>
                <p>The pause menu also makes a brief cameo! It's designed in a very simple way, and meant to replicate the pause menu from Ratchet & Clank 2002 while being legally distinct!</p>
                <h3 class="gradient-title">A Better Camera</h3>
                <p>The camera system has been replaced! This implementation simply uses <code>SpringArm3D</code> with a <code>Camera3D</code> as its child. This allows for the camera to not clip into walls (though it really likes clipping into the floor for some reason), and overall feels much more responsive. Not just that though – the player's movement input is now adjusted to where the camera points! When the player presses forward, they are now moving in the direction the camera is pointing. Previously, movement was independent from the camera's rotation, which of course wouldn't make sense for a game like this.</p>
                <h3 class="gradient-title">Look Where You're Jumping!</h3>
                <p>The character can jump! Jump height is set unnaturally high as a test. The player can double jump, but only from a grounded state; falling off a cliff counts as the first jump, thus only allowing the player to jump once. Also, gravity is broken again. Also, a player-controllable camera! This was implemented with a custom third person camera plugin, which proved to be a bit jumpy.</p>
                <h3 class="gradient-title">Gravity Functions As It Should</h3>
                <p>Gravity is fixed, and the camera angle has been adjusted, though not fixed to the character yet. It's kind of funny watching this little character move around.</p>
                <h3 class="gradient-title">One Small Step</h3>
                <p>A character has been added and the player can control them! It's influenced by gravity too, although it falls at an unnaturally rapid rate when thrown off the edge. This is because the downward velocity kept increasing even when grounded, and is fixed in a later version. Also, the character faces the wrong direction; moving forward results in the character facing the camera instead of forward. This is fixed once I replaced the character model with one where it's more obvious which side is forward.</p>
                <video width="500" controls class="video-block centred">
                    <source src="/resources/projects/projectn5/devlog/2023-09/test.mp4" type="video/mp4">
                    My code is fucked bro
                </video>
            </div>
        </div>
        <div id="rat-footer"></div>
    </body>
</html>